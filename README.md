Бизнес смысл: мы - один из сервисов интернет магазина. Мы отвечаем за апишку для фронтенда. Помимо нас есть и другие сервисы - учёт и администрирование товаров на складах, нотификаторы (sms, email), тарификаторы (для расчёта доставки) и прочие, о которых мы даже не знаем.

Наша зона ответственности - корзина, заказ и статус доставки этого заказа.

Мы также ответственны за админку, в которой есть управление заказами (и их статусами) и пользователями.

Товары мы получаем из топика, от соседнего сервиса учёта товаров. пример внизу страницы.

Неавторизованный пользователь может только лишь просматривать список товаров.

Авторизованный пользователь может заполнять корзину и делать заказ.

Для регистрации нужно указать имя, номер телефона и email. При регистрации пользователю должна прийти SMS с приветствием.

Для того, чтобы сделать заказ, пользователю нужно взять в корзину минимум 1 товар, указать свой номер телефона и выбрать способ доставки - курьер или самовывоз. В заказе не может быть более 20 позиций.

Статусы заказа могут быть такими: оплачен и ждёт сборки, в сборке, готов к выдаче/доставляется, получен или отменён.

Статус заказа может обновить админ и сообщение от соседнего сервиса.

А ещё у нас есть отчёты - каждый день сторонний сервис дёргает наш эндпоинт, который НАЧИНАЕТ генерацию отчёта. Этому отчёту присваивается какой то номер или бейджик, который мы и отдаём в ответе. По окончании генерации мы шлём событие в кафку о том, что отчёт сгенерирован. Сам по себе отчёт для простоты будем сохранять в локальный файл.

Что в отчёте: в отчёте у нас список всех проданных товаров т.е. если велосипед_10 купили 5 раз разные люди, то он 5 раз будет в этом отчёте. Это будет файл .jsonl вида:

```json
{"product_name": "велосипед_10", "price": 500, amount:1, "user": {"id":1}}
{"product_name": "велосипед_10", "price": 500, amount:1, "user": {"id":2}}
```

Всё, что касается общения с соседними сервисами, делаем на заглушках, но так, чтобы допилить их до потенциального реального проекта было максимально просто.

### Сообщение о изменении/создании товара

```json
{
	"id": int,
	"name": string,
	"measurments": {
		"weight": int,
		"height": int,
		"width": int,
		"lenght": int,
	}
	"description": ?string,
	"cost": int,
	"tax": int,
	"version": int
}
```

### Сообщение с уведомлением о заказе по sms/email

```json
{
	"type": "string", //"sms", "email",
	"userPhone": string, // if email type passed
	"userEmail": string, // if sms type passed
	"notificationType": string //"requires_payment", "success_payment", "completed"
	"orderNum": string,
	"orderItems": [
		{
			"name": string,
			"cost": int,
			"additionalInfo": ?string
		}
		...
	],
	"deliveryType": string // "selfdelivery", "courier"
	"deliveryAddress": {
		"kladrId": ?int,
		"fullAddress": ?string,
	}
}
```

### Сообщение с уведомлением о регистраципо sms/email

```json
{
	"type": "string", //"sms", "email",
	"userPhone": string, // if email type passed
	"userEmail": string, // if sms type passed
	"promoId": string //uuid4
}
```

### Сообщение ответом по отчёту

```json
{
	"reportId": string, //"ebca4412-3965-45a8-bd36-4c1d1b768e7b"
	"result": string // "success", "fail"
	"detail": { // поле обязательно только в случае ошибки
		"error": string,
		"message": ?string
	}
}
```